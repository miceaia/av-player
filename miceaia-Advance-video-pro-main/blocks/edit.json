import { useBlockProps, InspectorControls, MediaUpload, MediaUploadCheck } from '@wordpress/block-editor';
import { PanelBody, Button, TextControl, SelectControl, ToggleControl } from '@wordpress/components';
import './editor.css';

export default function Edit({ attributes, setAttributes }) {
    const { 
        src, 
        type, 
        poster, 
        width, 
        height, 
        autoplay, 
        loop, 
        controls,
        playback_rates 
    } = attributes;
    
    const blockProps = useBlockProps();

    return (
        <>
            <InspectorControls>
                <PanelBody title="üìπ Fuente de Video" initialOpen={true}>
                    <TextControl
                        label="URL del Video"
                        value={src}
                        onChange={(value) => setAttributes({ src: value })}
                        placeholder="https://ejemplo.com/video.mp4"
                        help="Ingresa la URL completa del video"
                    />
                    
                    <SelectControl
                        label="Tipo de Video"
                        value={type}
                        options={[
                            { label: 'Auto (detectar)', value: 'auto' },
                            { label: 'MP4', value: 'mp4' },
                            { label: 'WebM', value: 'webm' },
                            { label: 'YouTube', value: 'youtube' },
                            { label: 'Vimeo', value: 'vimeo' },
                            { label: 'HLS', value: 'hls' },
                            { label: 'DASH', value: 'dash' },
                        ]}
                        onChange={(value) => setAttributes({ type: value })}
                    />
                </PanelBody>

                <PanelBody title="üé® Apariencia">
                    <TextControl
                        label="Ancho"
                        value={width}
                        onChange={(value) => setAttributes({ width: value })}
                        placeholder="100%"
                        help="Ej: 100%, 800px, 50vw"
                    />
                    
                    <TextControl
                        label="Alto"
                        value={height}
                        onChange={(value) => setAttributes({ height: value })}
                        placeholder="500px"
                        help="Ej: 500px, 50vh"
                    />
                    
                    <TextControl
                        label="URL de Poster (Imagen)"
                        value={poster}
                        onChange={(value) => setAttributes({ poster: value })}
                        placeholder="https://ejemplo.com/portada.jpg"
                    />
                </PanelBody>

                <PanelBody title="‚öôÔ∏è Configuraci√≥n">
                    <ToggleControl
                        label="Reproducci√≥n autom√°tica"
                        checked={autoplay}
                        onChange={(value) => setAttributes({ autoplay: value })}
                        help="El video comienza autom√°ticamente"
                    />
                    
                    <ToggleControl
                        label="Repetir (Loop)"
                        checked={loop}
                        onChange={(value) => setAttributes({ loop: value })}
                        help="El video se repite al terminar"
                    />
                    
                    <ToggleControl
                        label="Mostrar controles"
                        checked={controls}
                        onChange={(value) => setAttributes({ controls: value })}
                        help="Play, pausa, volumen, etc."
                    />
                </PanelBody>

                <PanelBody title="‚è±Ô∏è Velocidades de Reproducci√≥n">
                    <TextControl
                        label="Velocidades disponibles"
                        value={playback_rates}
                        onChange={(value) => setAttributes({ playback_rates: value })}
                        placeholder="0.5,0.75,1,1.25,1.5,1.75,2"
                        help="Separadas por comas (sin espacios)"
                    />
                </PanelBody>
            </InspectorControls>

            <div {...blockProps}>
                <div style={{ 
                    width: '100%',
                    background: '#1f2937',
                    borderRadius: '8px',
                    padding: '20px',
                    textAlign: 'center',
                    color: '#fff',
                    border: '2px solid #4f46e5'
                }}>
                    {src ? (
                        <div>
                            <div style={{ fontSize: '48px', marginBottom: '10px' }}>‚ñ∂Ô∏è</div>
                            <p style={{ margin: '10px 0', fontWeight: 'bold' }}>Advanced Video Player</p>
                            <p style={{ margin: '5px 0', fontSize: '12px', opacity: 0.8 }}>{src}</p>
                            <p style={{ margin: '15px 0', fontSize: '11px', opacity: 0.6 }}>
                                {width} √ó {height}
                            </p>
                        </div>
                    ) : (
                        <div>
                            <div style={{ fontSize: '48px', marginBottom: '10px' }}>üìπ</div>
                            <p style={{ margin: '10px 0', fontWeight: 'bold' }}>Advanced Video Player</p>
                            <p style={{ margin: '5px 0', fontSize: '12px', opacity: 0.8 }}>
                                A√±ade una URL de video en el panel de la derecha
                            </p>
                        </div>
                    )}
                </div>
            </div>
        </>
    );
}